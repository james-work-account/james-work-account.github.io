<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interesting Scala</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="js/custom.js"></script>
    <link rel="stylesheet" href="css/custom.css">
</head>
<body>
    <div class="content">
        <header>
        <div class="jumbotron text-center">
            <h1>SCALA DUMP ZONE</h1>
            <p>Helper page for Scala snippets</p>
        </div>
        <nav class="navigation">
            <input type="checkbox" id="dropdown-menu" />
            <div class="dropdown-menu-title">
                <label for="dropdown-menu" onclick="toggleHamburger()">Menu&nbsp;&nbsp;>&nbsp;&nbsp;Interesting
                    <div class="hamburger-box">
                        <div class="hamburger-inner"></div>
                    </div>
                </label>
            </div>
            <ul class="nav nav-tabs" role="tablist">
                <li><a href="index.html">Home</a></li>
                <li class="active"><a href="#">Interesting</a></li>
                <li><a href="regex.html">Regex</a></li>
                <li><a href="xml.html">XML</a></li>
                <li><a href="#">AWS</a></li>
            </ul>
        </nav>
    </header>


        <div class="content-body">
            <ul class="list-group">
            <li class="list-group-item">
                <button type="button" class="code-name collapsed" data-toggle="collapse" data-target="#onSuccess">onSuccess inside a function
                </button>
                <div id="onSuccess" class="collapse">
                    <h4>Passing a function as a curried parameter to create an onSuccess block</h4>
                    <p>You can turn a function into a Higher-Order Function and curry your parameters in order to avoid duplicated code, and to make code blocks more human-readable through abstracting methods which might otherwise look cumbersome.</p>
                    <p>Example: with Scala Play, turning a POST request's body into JSON and custom-handling any errors with a <code>Try</code> block. If the <code>Try</code> is successful in this example, the JSON will be passed as a parameter into the <code>JsValue -> Future[Result]</code> block to later be converted from JSON into a <code>Future[Result]</code>.</p>

        <pre>
def requestToJson(request: Request[AnyContent])(onSuccess: => JsValue => Future[Result]): Future[Result] = {
  Try(request.body.asJson.get) match {
    case Success(json) => onSuccess(json)
    case Failure(_) => Future.successful(UnsupportedMediaType("This is not JSON..."))
  }
}
</pre>
                    <hr>

                    <h4>Use:</h4>
<pre>
def handleGet(): Action[AnyContent] = Action.async(parse.anyContent) {
  implicit request =>
    requestToJson(request) {
      json =>
        Future.successful(Ok(json))
    }
}
</pre>
                </div>
            </li>
            <li class="list-group-item">
                <button type="button" class="code-name collapsed" data-toggle="collapse" data-target="#either">Either[Left, Right]
                </button>
                <div id="either" class="collapse">
                    <h4>Catching exceptions with <span class="code"><em>Either</em>[<em>Left</em>, <em>Right</em>]</span></h4>

                    <p>Use similar to <code>Option</code></p>
                    <p>Example, storing either a <code>Throwable</code> or a <code>String</code> as a form of validation:</p>
                    <pre>
scala> def isCorrectString(input: String): Either[Throwable, String] = {
     |   if(input == "I match perfectly") Right("IT'S A MATCH")
     |   else Left(new Exception("It didn't match..."))
     | }
isCorrectString: (input: String)Either[Throwable,String]

scala> isCorrectString("I match perfectly")
res0: Either[Throwable,String] = Right(IT'S A MATCH)

scala> isCorrectString("I do not match perfectly")
res1: Either[Throwable,String] = Left(java.lang.Exception: It didn't match...)
    </pre>
                    <hr>

                    <h4>Checking if a <code>Collection</code> contains a <code>Left</code></h4>
                    <p>An example of where this can be useful is if you are making multiple POST requests to an API and want to verify that they have all passed.</p>
                    <p>You would do this by checking if a Collection contains any <code>Left</code> values with <code>.exists(_.isLeft)</code>.</p>
                    <pre>
scala> val seq: Seq[Either[Int, String]] = Seq(Right("string"), Right("string"), Left(3), Right("string"))
seq: Seq[Either[Int,String]] = List(Right(string), Right(string), Left(3), Right(string))

scala> seq.exists(_.isLeft)
res0: Boolean = true

scala> val seq2: Seq[Either[Int, String]] = Seq(Right("string"), Right("string"), Right("string"))
seq2: Seq[Either[Int,String]] = List(Right(string), Right(string), Right(string))

scala> seq2.exists(_.isLeft)
res1: Boolean = false
                    </pre>
                    <hr>

                    <h4><code>Either</code> in <code>for</code> comprehensions</h4>
                    <p>Another way to see if there is a <code>Left</code> in your results is to use a <code>for</code> comprehension to handle each value.</p>
                    <p>The <code>for</code> comprehension will fall over at the line containing the <code>Left</code>, and will subsequently not analyse the rest of the comprehension.</p>
                    <p>This is helpful if you want to capture at which point an error occurred when debugging your code.</p>
                    <p style="font-weight: bold">Setup:</p>
                    <pre>
scala> case class Error(msg: String)
defined class Error

scala> type Validation[+A] = Either[Error, A]
defined type alias Validation

scala> val result1: Validation[Int] = Right(42)
result1: Validation[Int] = Right(42)

scala> val result2: Validation[String] = Right("Is the Answer")
result2: Validation[String] = Right(Is the Answer)

scala> val result3: Validation[Int] = Left(Error("Ooops Failed"))
result3: Validation[Int] = Left(Error(Ooops Failed))
                    </pre>
                    <p style="font-weight: bold">Putting each <code style="font-weight: normal">Right</code> in a <code style="font-weight: normal">Seq</code>:</p>
                    <pre>
scala> val response = for {
     |   res1 <- result1.right
     |   res2 <- result2.right
     |   res3 <- result3.right
     | } yield {
     |   Seq(res1, res2, res3)
     | }
response: scala.util.Either[Error,Seq[Any]] = Left(Error(Ooops Failed))
                    </pre>
                    <p style="font-weight: bold">The comprehension even falls over if you don't end up using the <code style="font-weight: normal">Left</code> value:</p>
                    <pre>
scala> val response2 = for {
     |   res1 <- result1.right
     |   res2 <- result2.right
     |   res3 <- result3.right
     | } yield {
     |   Seq(res1, res2)
     | }
response2: scala.util.Either[Error,Seq[Any]] = Left(Error(Ooops Failed))
                    </pre>
                    <p style="font-weight: bold">The comprehension will pass if all of the values are <code style="font-weight: normal">Right</code>:</p>
                    <pre>
scala> val respose3 = for {
     |   res1 <- result1.right
     |   res2 <- result2.right
     | } yield {
     |   Seq(res1, res2)
     | }
respose3: scala.util.Either[Error,Seq[Any]] = Right(List(42, Is the Answer))
                    </pre>
                </div>
            </li>
        </ul>
    </div>
    </div>
    <footer>
        <h3>My links:</h3>
        <ul class="list-unstyled">
            <li><button type="button" class="btn btn-so" id="so-icon" onclick="location.href='https://stackoverflow.com/users/8230810/james-whiteley'"><i class="fa fa-stack-overflow pr-1"></i></button></li>
            <li><button type="button" class="btn btn-git" id="git-icon" onclick="location.href='https://github.com/james-work-account'"><i class="fa fa-github pr-1"></i></button></li>
            <li><button type="button" class="btn btn-so" onclick="location.href='https://stackoverflow.com/users/8230810/james-whiteley'"><i class="fa fa-stack-overflow pr-1"></i>&nbsp;Stack Overflow</button></li>
            <li><button type="button" class="btn btn-git" onclick="location.href='https://github.com/james-work-account'"><i class="fa fa-github pr-1"></i>&nbsp;Github</button></li>
        </ul>
    </footer>
</body>
</html>